<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, viewport-fit=cover">
  <title>LyxNexus Â· class portal</title>
  <meta name="keywords" content="Lyx Nexus, Kisii LyxNexus, kisii lyxnexus, kisii university lyxnexus, kisii university lyx nexus, lyx nexus, lyxnexus" />
  <meta name="author" content="Vincent Kipngetich" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://lyxnexus.onrender.com/" />
  <link rel="icon" href="https://lyxnexus.onrender.com/uploads/favicon-1.png"/>
  <meta property="og:title" content="LyxNexus | Class Portal" />
  <meta property="og:description" content="LyxNexus is a simple yet powerful class hub designed to keep everything in one place â€” from announcements and assignments to topics and class discussions." />
  <meta property="og:image" content="https://lyxnexus.onrender.com/favicon.ico" />
  <meta property="og:url" content="https://lyxnexus.onrender.com/" />
  <meta name="twitter:card" content="summary" />
  <meta name="google-site-verification" content="sJ42XyhDu5tg-Paz5vI6KgPbhqVKqfdNNX0cZHsbifU" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="{{ url_for('tailwindcss') }}"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

  <style>
    :root {
      --bg-deep: #0f172a;
      --bg-void: #0a0f1a;
      --accent-blue: #3b82f6;
      --accent-purple: #8b5cf6;
      --glass-bg: rgba(15, 23, 42, 0.7);
      --glass-border: rgba(59, 130, 246, 0.2);
      --glass-highlight: rgba(255, 255, 255, 0.03);
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-deep);
      color: #f1f5f9;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .glass-panel {
      background: rgba(15, 23, 42, 0.65);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      border: 1px solid rgba(59, 130, 246, 0.1);
      border-bottom: 1px solid rgba(255,255,255,0.03);
      box-shadow: 0 20px 35px -15px rgba(0,0,0,0.5);
    }

    .glass-card {
      background: rgba(15, 23, 42, 0.55);
      backdrop-filter: blur(14px) saturate(180%);
      -webkit-backdrop-filter: blur(14px) saturate(180%);
      border: 1px solid var(--glass-border);
      border-bottom-width: 2px;
      transition: all 0.25s cubic-bezier(0.2,0,0,1);
      box-shadow: 0 15px 30px -15px rgba(0,0,0,0.6);
    }
    .glass-card:hover {
      background: rgba(25, 38, 58, 0.7);
      border-color: rgba(59, 130, 246, 0.4);
      box-shadow: 0 25px 40px -15px rgba(59,130,246,0.25);
      transform: translateY(-3px);
    }

    .gradient-brand {
      background: linear-gradient(145deg, var(--accent-blue), var(--accent-purple), #c084fc);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .floating-dots {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        overflow: hidden;
    }
    
    .dot {
        position: absolute;
        background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
        border-radius: 50%;
        opacity: 0.7;
        animation: floatDot linear infinite;
    }
    
    @keyframes floatDot {
        0% {
            transform: translateY(100vh) translateX(0) rotate(0deg);
            opacity: 0;
        }
        10% {
            opacity: 0.5;
        }
        90% {
            opacity: 0.7;
        }
        100% {
            transform: translateY(-100px) translateX(100px) rotate(360deg);
            opacity: 0;
        }
    }
    .section-title {
      position: relative;
      display: inline-block;
      font-weight: 700;
      margin-bottom: 2rem;
    }
    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -10px;
      width: 70px;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
      border-radius: 4px;
      box-shadow: 0 0 12px var(--accent-blue);
    }

    .scroll-fade {
      max-height: 560px;
      overflow-y: auto;
      -webkit-mask-image: linear-gradient(to bottom, transparent, black 8%, black 92%, transparent);
      mask-image: linear-gradient(to bottom, transparent, black 8%, black 92%, transparent);
      scrollbar-width: thin;
      scrollbar-color: rgba(59,130,246,0.4) rgba(15,23,42,0.3);
    }
    .scroll-fade::-webkit-scrollbar {
      width: 5px;
    }
    .scroll-fade::-webkit-scrollbar-track {
      background: rgba(15,23,42,0.3);
      border-radius: 10px;
    }
    .scroll-fade::-webkit-scrollbar-thumb {
      background: rgba(59,130,246,0.5);
      border-radius: 10px;
    }

    .orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(100px);
      z-index: 0;
      animation: float 30s infinite alternate ease-in-out;
    }
    .orb-1 { width: 40vw; height: 40vw; left: -10vw; top: -10vh; background: radial-gradient(circle, rgba(59,130,246,0.18), transparent 80%); }
    .orb-2 { width: 50vw; height: 50vw; right: -15vw; bottom: -15vh; background: radial-gradient(circle, rgba(139,92,246,0.15), transparent 80%); animation-delay: -7s; }
    @keyframes float { 0% { transform: translate(0,0) scale(1); } 100% { transform: translate(5%,8%) scale(1.1); } }

    .nav-glass {
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(59,130,246,0.2);
    }

    .btn-glow {
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
      border-radius: 40px;
      padding: 0.7rem 2rem;
      font-weight: 600;
      color: white;
      box-shadow: 0 8px 20px rgba(59,130,246,0.3);
      transition: all 0.2s;
    }
    .btn-glow:hover {
      box-shadow: 0 12px 28px rgba(59,130,246,0.5);
      transform: scale(1.02);
    }

    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
      box-shadow: 0 0 12px var(--accent-blue);
      z-index: 100;
      transition: width 0.1s;
    }

    .year-badge {
      backdrop-filter: blur(4px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .mobile-bottom-nav {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(24px);
      border-top: 1px solid rgba(59,130,246,0.2);
    }

    .no-scrollbar::-webkit-scrollbar { display: none; }
  </style>
</head>
<body class="antialiased relative">
  <button id="backToTop" class="fixed bottom-24 right-6 md:bottom-10 md:right-10 w-12 h-12 rounded-full bg-blue-600/30 backdrop-blur border border-blue-400/50 text-white text-xl shadow-lg hover:bg-blue-600/50 transition-all duration-300 z-50 hidden">
    <i class="fas fa-arrow-up"></i>
  </button>
  <div class="floating-dots" id="dots"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>

  <div class="progress-bar" id="scrollProgress"></div>
  <nav class="nav-glass sticky top-0 z-50 px-4 md:px-8 py-3">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="bg-gradient-to-br from-blue-600/30 to-purple-600/30 p-2.5 rounded-2xl backdrop-blur border border-white/10 shadow-xl">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.8">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            <polyline points="7.5 4.21 12 6.81 16.5 4.21"/>
            <line x1="12" y1="22.08" x2="12" y2="12"/>
          </svg>
        </div>
        <span class="text-2xl md:text-3xl font-black gradient-brand">LyxNexus</span>
      </div>
      <!-- desktop menu -->
      <div class="hidden md:flex items-center gap-1">
        <a href="#" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Home</a>
        <a href="#features" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Features</a>
        <a href="#announcements" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Announce</a>
        <a href="#assignments" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Assign</a>
        <a href="#topics" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Units</a>
        <a href="#timetable" class="px-4 py-2 text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 rounded-full transition">Schedule</a>
      </div>
      <button onclick="window.location.href='/login'" class="btn-glow text-sm md:text-base flex items-center gap-2">
        <i class="fas fa-sign-in-alt fa-bounce"></i>
        <span>Login</span>
      </button>
    </div>
  </nav>

  <main class="relative max-w-7xl mx-auto px-4 md:px-8 py-8 md:py-16 z-10">
    <section class="flex flex-col lg:flex-row gap-12 items-center mb-28">
      <div class="flex-1">
        <span class="inline-block px-4 py-1.5 rounded-full bg-white/5 backdrop-blur border border-white/10 text-xs uppercase tracking-wider text-blue-300 mb-6">
          âœ¦ smart class hub
        </span>
        <h1 class="text-4xl md:text-6xl font-extrabold leading-tight tracking-tight">
          <span class="text-white">Everything</span><br>
          <span class="gradient-brand">your class needs.</span>
        </h1>
        <div class="mt-6 text-lg md:text-xl text-slate-300 max-w-xl">
          <span id="typed-hero"></span>
        </div>
        <div class="flex flex-wrap gap-4 mt-10">
          <button onclick="window.location.href='/login'" class="btn-glow text-base px-6 py-3">
            <i class="fas fa-rocket mr-2"></i> Explore
          </button>
          <button onclick="window.location.href='/ln-ads'" class="bg-transparent border border-blue-500/60 hover:bg-blue-500/10 rounded-full px-6 py-3 text-white font-medium transition">
            <i class="fas fa-play-circle mr-2"></i> How it works
          </button>
        </div>
      </div>
      <div class="flex-1 flex justify-center">
        <div class="glass-card w-full max-w-md p-1 rounded-3xl">
          <div class="rounded-3xl bg-gradient-to-br from-blue-900/30 via-purple-900/20 to-slate-900/40 p-8 backdrop-blur-sm flex flex-col items-center border border-white/5">
            <div class="w-24 h-24 rounded-3xl bg-blue-500/20 flex items-center justify-center text-5xl text-blue-300 mb-4">
              <i class="fas fa-diagram-project"></i>
            </div>
            <h3 class="text-3xl font-bold gradient-brand">unified.</h3>
            <p class="text-slate-300 text-center mt-3 text-sm max-w-xs">
              Announcements Â· Assignments Â· Timetable Â· Units<br>One link, one login.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="features" class="scroll-mt-24 mb-28">
      <h2 class="section-title text-3xl md:text-4xl font-bold text-white">why LyxNexus?</h2>
      <p class="text-slate-400 mt-4 text-lg max-w-2xl">Designed to replace scattered links and missed deadlines. Realâ€‘time, private, and intuitive.</p>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-12">
        <div class="glass-card p-6 rounded-2xl">
          <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center text-2xl text-blue-400 mb-4">
            <i class="fas fa-bullhorn"></i>
          </div>
          <h4 class="text-white font-bold text-lg">Instant announcements</h4>
          <p class="text-slate-400 text-sm mt-2">Push updates to specific years or everyone â€” with files, formatting, and priority.</p>
        </div>
        <div class="glass-card p-6 rounded-2xl">
          <div class="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center text-2xl text-purple-400 mb-4">
            <i class="fas fa-tasks"></i>
          </div>
          <h4 class="text-white font-bold text-lg">Assignment hub</h4>
          <p class="text-slate-400 text-sm mt-2">Review, grade. Deadlines, rubrics, and feedback â€” no more WhatsApp chaos.</p>
        </div>
        <div class="glass-card p-6 rounded-2xl">
          <div class="w-12 h-12 rounded-xl bg-cyan-500/20 flex items-center justify-center text-2xl text-cyan-400 mb-4">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <h4 class="text-white font-bold text-lg">Live timetable</h4>
          <p class="text-slate-400 text-sm mt-2">Weekly schedule with rooms, lecturers, and realâ€‘time changes.</p>
        </div>
        <div class="glass-card p-6 rounded-2xl">
          <div class="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center text-2xl text-emerald-400 mb-4">
            <i class="fas fa-layer-group"></i>
          </div>
          <h4 class="text-white font-bold text-lg">Unit library</h4>
          <p class="text-slate-400 text-sm mt-2">Notes, past papers, slides â€” per course, per year, always accessible.</p>
        </div>
      </div>
    </section>

    <section id="announcements" class="scroll-mt-24 mb-20">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center text-2xl backdrop-blur border border-white/5">
          <i class="fas fa-bullhorn text-blue-400 fa-shake"></i>
        </div>
        <div>
          <h2 class="text-3xl md:text-4xl font-bold text-white">Latest announcements</h2>
          <p class="text-slate-400 text-sm mt-1">realâ€‘time from majuu Â· scrollable</p>
        </div>
      </div>
      
      <div id="announcements-container" class="scroll-fade pr-2 pb-8 pt-8 space-y-5">
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse flex space-x-4">
            <div class="rounded-full bg-slate-700 h-10 w-10"></div>
            <div class="flex-1 space-y-3 py-1">
              <div class="h-4 bg-slate-700 rounded w-3/4"></div>
              <div class="h-3 bg-slate-700 rounded"></div>
              <div class="h-3 bg-slate-700 rounded w-5/6"></div>
            </div>
          </div>
        </div>
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse flex space-x-4">
            <div class="rounded-full bg-slate-700 h-10 w-10"></div>
            <div class="flex-1 space-y-3 py-1">
              <div class="h-4 bg-slate-700 rounded w-3/4"></div>
              <div class="h-3 bg-slate-700 rounded"></div>
              <div class="h-3 bg-slate-700 rounded w-5/6"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="text-right mt-4">
        <span class="text-xs text-slate-400 bg-white/5 px-4 py-1.5 rounded-full backdrop-blur">
          <i class="fas fa-arrow-up mr-1"></i> scroll for more
        </span>
      </div>
    </section>

    <section id="assignments" class="scroll-mt-24 mb-20">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center text-2xl backdrop-blur border border-white/5">
          <i class="fas fa-tasks text-purple-400"></i>
        </div>
        <div>
          <h2 class="text-3xl md:text-4xl font-bold text-white">Current assignments</h2>
          <p class="text-slate-400 text-sm mt-1">deadlines & details</p>
        </div>
      </div>
    
      <div id="assignments-container" class="grid grid-cols-1 md:grid-cols-2 gap-6 scroll-fade pr-1 pb-8 pt-8">
        <!-- skeletons -->
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse space-y-3">
            <div class="h-5 bg-slate-700 rounded w-1/2"></div>
            <div class="h-3 bg-slate-700 rounded"></div>
            <div class="h-3 bg-slate-700 rounded w-4/5"></div>
          </div>
        </div>
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse space-y-3">
            <div class="h-5 bg-slate-700 rounded w-1/2"></div>
            <div class="h-3 bg-slate-700 rounded"></div>
            <div class="h-3 bg-slate-700 rounded w-4/5"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="topics" class="scroll-mt-24 mb-20">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center text-2xl backdrop-blur border border-white/5">
          <i class="fas fa-book-open text-emerald-400"></i>
        </div>
        <div>
          <h2 class="text-3xl md:text-4xl font-bold text-white">Course Units</h2>
          <p class="text-slate-400 text-sm mt-1">learning modules</p>
        </div>
      </div>
      <div id="topics-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 scroll-fade pr-1 pb-8 pt-8">
        <!-- skeletons -->
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse space-y-3">
            <div class="h-5 bg-slate-700 rounded w-2/3"></div>
            <div class="h-3 bg-slate-700 rounded"></div>
          </div>
        </div>
        <div class="glass-card p-5 rounded-xl">
          <div class="animate-pulse space-y-3">
            <div class="h-5 bg-slate-700 rounded w-2/3"></div>
            <div class="h-3 bg-slate-700 rounded"></div>
          </div>
        </div>
      </div>
    </section>
    
    <section id="timetable" class="scroll-mt-24 mb-20 pb-8 pt-8">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-12 h-12 rounded-xl bg-amber-500/20 flex items-center justify-center text-2xl backdrop-blur border border-white/5">
          <i class="fas fa-clock text-amber-400 fa-beat-fade"></i>
        </div>
        <div>
          <h2 class="text-3xl md:text-4xl font-bold text-white">Class timetable</h2>
          <p class="text-slate-400 text-sm mt-1">weekly schedule</p>
        </div>
      </div>
      <div id="timetable-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="glass-card p-5 rounded-xl h-40 animate-pulse"></div>
        <div class="glass-card p-5 rounded-xl h-40 animate-pulse"></div>
      </div>
    </section>

    <footer class="mt-20 mb-28 glass-panel rounded-3xl p-8 md:p-12 border-t border-blue-500/20">
      <div class="flex flex-col md:flex-row justify-between items-center gap-6">
        <div class="flex items-center gap-3">
          <div class="bg-gradient-to-br from-blue-600/30 to-purple-600/30 p-2 rounded-xl">
            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.8">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            <polyline points="7.5 4.21 12 6.81 16.5 4.21"/>
            <line x1="12" y1="22.08" x2="12" y2="12"/>
          </svg>
          </div>
          <span class="text-2xl font-bold gradient-brand">LyxNexus</span>
        </div>
        <p class="text-slate-400 text-sm">Flexibity and Innovation is the key to success â€” class ecosystem.</p>
        <div class="flex gap-5 text-slate-400">
          <a href="https://wa.me/254112167195" target="_blank" class="hover:text-blue-400 transition text-xl"><i class="fab fa-whatsapp"></i></a>
          <a href="mailto:vincentkipgetich479@gmail.com" target="_blank" class="hover:text-blue-400 transition text-xl"><i class="fas fa-envelope"></i></a>
          <a href="https://www.linkedin.com/in/vincent-kipngetich-44bb84394/" target="_blank" class="hover:text-blue-400 transition text-xl"><i class="fab fa-linkedin"></i></a>
          <a href="https://www.tiktok.com/@daudikibetrono" target="_blank" class="hover:text-blue-400 transition text-xl"><i class="fab fa-tiktok"></i></a>
        </div>
      </div>
      <div class="border-t border-white/5 mt-8 pt-6 text-center text-slate-500 text-xs">
        <p>Â© {{ year }} LyxNexus â€” Kisii University All rights reserved.</p>
      </div>
    </footer>
  </main>

  <div class="mobile-bottom-nav fixed bottom-0 left-0 right-0 md:hidden flex justify-around items-center px-2 py-2 z-50">
    <a href="#" class="flex flex-col items-center p-2 text-white/70 hover:text-blue-400 transition-colors">
      <i class="fas fa-home text-xl"></i>
      <span class="text-[10px] mt-1">Home</span>
    </a>
    <a href="#announcements" class="flex flex-col items-center p-2 text-white/70 hover:text-blue-400">
      <i class="fas fa-bullhorn text-xl"></i>
      <span class="text-[10px] mt-1">News</span>
    </a>
    <a href="#assignments" class="flex flex-col items-center p-2 text-white/70 hover:text-blue-400">
      <i class="fas fa-tasks text-xl"></i>
      <span class="text-[10px] mt-1">Tasks</span>
    </a>
    <a href="#topics" class="flex flex-col items-center p-2 text-white/70 hover:text-blue-400">
      <i class="fas fa-book text-xl"></i>
      <span class="text-[10px] mt-1">Units</span>
    </a>
    <a href="#timetable" class="flex flex-col items-center p-2 text-white/70 hover:text-blue-400">
      <i class="fas fa-calendar text-xl"></i>
      <span class="text-[10px] mt-1">Time</span>
    </a>
  </div>

  <script>
    const toastSystem = {
      container: document.getElementById('toast-container') || (() => { 
        const div = document.createElement('div'); 
        div.id = 'toast-container'; 
        div.className = 'fixed top-24 right-6 z-[100] flex flex-col gap-3 max-w-sm pointer-events-none';
        document.body.appendChild(div); 
        return div; })(),
      show(msg, title = 'Notification', type = 'info', duration = 5000) {
        const id = Date.now();
        const toast = document.createElement('div');
        toast.className = `glass-card px-5 py-4 flex items-start gap-3 translate-x-full opacity-0 transition-all duration-500 rounded-xl border-l-4 ${type==='success'?'border-green-500':type==='error'?'border-red-500':'border-blue-500'}`;
        toast.style.transform = 'translateX(120%)';
        toast.innerHTML = `
          <div class="text-${type==='success'?'green':type==='error'?'red':'blue'}-400 text-xl"><i class="fas ${type==='success'?'fa-check-circle':type==='error'?'fa-exclamation-circle':'fa-info-circle'}"></i></div>
          <div class="flex-1"><div class="font-semibold text-white">${title}</div><div class="text-slate-300 text-sm">${msg}</div></div>
          <button class="text-slate-400 hover:text-white" onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>
        `;
        this.container.appendChild(toast);
        setTimeout(() => { toast.style.transform = 'translateX(0)'; toast.style.opacity = '1'; }, 20);
        setTimeout(() => { toast.style.transform = 'translateX(120%)'; toast.style.opacity = '0'; setTimeout(() => toast.remove(), 500); }, duration);
      },
      success: (m, t) => toastSystem.show(m, t, 'success'),
      error: (m, t) => toastSystem.show(m, t, 'error'),
      info: (m, t) => toastSystem.show(m, t, 'info')
    };

    const API_BASE = '/api';
    const ENDPOINTS = {
      ANNOUNCEMENTS: `${API_BASE}/announcements`,
      ASSIGNMENTS: `${API_BASE}/assignments`,
      TIMETABLE: `${API_BASE}/timetable/grouped`,
      TOPICS: `${API_BASE}/topics`
    };

    function formatDate(dateString) {
      const d = new Date(dateString);
      return d.toLocaleString(undefined, { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true });
    }

    function getFileIcon(filename) {
      if (!filename) return 'fas fa-file';
      const ext = filename.split('.').pop().toLowerCase();
      const map = {
        pdf: 'fas fa-file-pdf', doc: 'fas fa-file-word', docx: 'fas fa-file-word',
        xls: 'fas fa-file-excel', xlsx: 'fas fa-file-excel',
        ppt: 'fas fa-file-powerpoint', pptx: 'fas fa-file-powerpoint',
        zip: 'fas fa-file-archive', rar: 'fas fa-file-archive',
        mp3: 'fas fa-file-audio', mp4: 'fas fa-file-video',
        jpg: 'fas fa-file-image', jpeg: 'fas fa-file-image', png: 'fas fa-file-image',
        html: 'fas fa-file-code', js: 'fas fa-file-code', css: 'fas fa-file-code',
      };
      return map[ext] || 'fas fa-file-alt';
    }

    function formatText(text) {
      if (!text) return '';
      let s = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
      return s
        .replace(/\*(.*?)\*/g, '<strong>$1</strong>')
        .replace(/_(.*?)_/g, '<em>$1</em>')
        .replace(/~(.*?)~/g, '<span class="line-through text-slate-400">$1</span>')
        .replace(/==(.*?)==/g, '<span class="bg-blue-500/30 px-1 rounded">$1</span>');
    }

    function formatMath(html) {
      try {
        renderMathInElement(document.createElement('span'), { delimiters: [{ left: '$', right: '$', display: false }], throwOnError: false });
      } catch(e) {}
      return html;
    }

    async function fetchData(endpoint) {
      try {
        const res = await fetch(endpoint);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        return await res.json();
      } catch (e) {
        console.error(`fetch ${endpoint} failed:`, e);
        return [];
      }
    }

    async function loadAnnouncements() {
      const container = document.getElementById('announcements-container');
      container.innerHTML = `...`;
      container.innerHTML = ` 
        <div class="glass-card p-5 rounded-xl animate-pulse"><div class="h-4 bg-slate-700 rounded w-3/4 mb-3"></div><div class="h-3 bg-slate-700 rounded"></div><div class="h-3 bg-slate-700 rounded w-5/6 mt-2"></div></div>
        <div class="glass-card p-5 rounded-xl animate-pulse"><div class="h-4 bg-slate-700 rounded w-3/4 mb-3"></div><div class="h-3 bg-slate-700 rounded"></div><div class="h-3 bg-slate-700 rounded w-5/6 mt-2"></div></div>
      `;
      const data = await fetchData(ENDPOINTS.ANNOUNCEMENTS);
      if (!data.length) {
        container.innerHTML = '<p class="text-slate-400 py-6 text-center glass-card p-6">ðŸ“­ No announcements yet.</p>';
        return;
      }
      document.getElementById('announcements-count')?.remove();
      container.innerHTML = data.map(a => {
        const fileHtml = a.has_file ? `
          <div class="flex items-center gap-3 mt-3 px-3 py-2 bg-white/5 rounded-xl border border-white/10 text-sm">
            <i class="${getFileIcon(a.file_name)} text-blue-400"></i>
            <span class="truncate text-white/80">${a.file_name || 'attachment'}</span>
          </div>` : '';
        const year = a.author?.year || 0;
        const badgeColor = year === 5 ? 'from-red-600 to-red-500' : year === 1 ? 'from-blue-600 to-blue-500' : year === 2 ? 'from-purple-600 to-purple-500' : year === 3 ? 'from-green-600 to-green-500' : year === 4 ? 'from-yellow-600 to-yellow-500' : 'from-slate-600 to-slate-500';
        return `
        <div class="glass-card p-5 rounded-xl relative overflow-hidden">
          <span class="year-badge absolute top-1 -left-2 px-4 py-1.5 rounded-r-full bg-gradient-to-r ${badgeColor} text-white text-xs font-bold shadow-lg z-10">
            <i class="fas fa-graduation-cap mr-1"></i>${year === 5 ? 'All years' : `Year ${year}`}
          </span>
          <div class="mt-4">
            <h3 class="text-xl font-bold text-white underline decoration-blue-500/50 decoration-2 underline-offset-4 mb-2">${a.title}</h3>
            ${fileHtml}
            <p class="text-slate-300 text-sm leading-relaxed mt-3 formatted-text">${formatText(a.content)}</p>
            <div class="flex justify-between items-center mt-4 text-xs text-slate-400">
              <span><i class="fas fa-user mr-1"></i>${a.author?.username || 'staff'}</span>
              <span><i class="fas fa-calendar mr-1"></i>${formatDate(a.created_at)}</span>
              <button class="text-blue-400 hover:text-blue-300 transition" onclick="toastSystem.info('ðŸ” Login to view full details','Authentication')">More <i class="fas fa-arrow-right ml-1 text-xs"></i></button>
            </div>
          </div>
        </div>`; }).join('');
    }

    async function loadAssignments() {
      const container = document.getElementById('assignments-container');
      container.innerHTML = `...`; // skeletons
      const data = await fetchData(ENDPOINTS.ASSIGNMENTS);
      if (!data.length) { container.innerHTML = '<p class="text-slate-400 col-span-2 text-center glass-card p-6">ðŸ“‹ No assignments found.</p>'; return; }
      container.innerHTML = data.map(a => {
        const due = new Date(a.due_date);
        const now = new Date();
        const days = Math.ceil((due - now)/(1000*60*60*24));
        let badge = days < 0 ? 'bg-red-500/20 text-red-300 border-red-500/30' : days <= 2 ? 'bg-orange-500/20 text-orange-300 border-orange-500/30' : 'bg-green-500/20 text-green-300 border-green-500/30';
        let status = days < 0 ? 'Overdue' : days <= 2 ? 'Soon' : 'Upcoming';
        const fileHtml = a.file_name ? `<div class="flex items-center gap-2 text-xs mt-2"><i class="${getFileIcon(a.file_name)} text-blue-400"></i><span class="truncate text-white/70">${a.file_name}</span></div>` : '';
        const year = a.creator?.year || 0;
        const badgeColor = year === 5 ? 'from-red-600 to-red-500' : year === 1 ? 'from-blue-600 to-blue-500' : year === 2 ? 'from-purple-600 to-purple-500' : year === 3 ? 'from-green-600 to-green-500' : 'from-slate-600 to-slate-500';
        return `
        <div class="glass-card p-5 rounded-xl relative">
          <span class="year-badge absolute -top-2 -left-2 px-4 py-1.5 rounded-r-full bg-gradient-to-r ${badgeColor} text-white text-xs font-bold">Year ${year === 5 ? 'All' : year}</span>
          <div class="flex justify-between items-start mt-2">
            <h3 class="text-lg font-bold text-white">${a.title}</h3>
            <span class="text-xs px-3 py-1 rounded-full ${badge} border backdrop-blur-sm">${status}</span>
          </div>
          <p class="text-slate-300 text-sm mt-2">${formatMath(a.description)}</p>
          ${fileHtml}
          <div class="flex justify-between items-center mt-4 text-xs">
            <span class="text-slate-400">ðŸ“Œ ${a.topic?.name || 'General'}</span>
            <span class="text-blue-400"><i class="far fa-calendar-alt mr-1"></i>${formatDate(a.due_date)}</span>
          </div>
          <button class="mt-4 w-full py-2 rounded-lg bg-white/5 border border-white/10 hover:bg-blue-500/20 text-sm transition" onclick="window.location.href='/assignment/${a.id}'">View details</button>
        </div>`; }).join('');
    }

    async function loadTopics() {
      const container = document.getElementById('topics-container');
      const data = await fetchData(ENDPOINTS.TOPICS);
      if (!data.length) { container.innerHTML = '<p class="text-slate-400 col-span-3 text-center glass-card p-6">ðŸ“š No topics available.</p>'; return; }
      container.innerHTML = data.map(t => {
        const badgeColor = t.year === 5 ? 'from-red-600 to-red-500' : t.year === 1 ? 'from-blue-600 to-blue-500' : t.year === 2 ? 'from-purple-600 to-purple-500' : t.year === 3 ? 'from-green-600 to-green-500' : 'from-slate-600 to-slate-500';
        return `
        <div class="glass-card p-5 rounded-xl relative text-center">
          <span class="year-badge absolute -top-4 -left-2 px-4 py-1.5 rounded-r-full bg-gradient-to-r ${badgeColor} text-white text-xs font-bold">Year ${t.year === 5 ? 'All' : t.year}</span>
          <div class="w-14 h-14 mx-auto rounded-2xl bg-white/5 flex items-center justify-center text-3xl text-cyan-400 mb-3 border border-white/5">
            <i class="fas fa-atom"></i>
          </div>
          <h3 class="text-xl font-bold text-white">${t.name}</h3>
          <p class="text-xs text-blue-300/80 mt-1">${t.lecturer || 'lecturer'}</p>
          <p class="text-slate-400 text-sm mt-3">${t.description}</p>
          <button class="mt-5 w-full py-2 rounded-lg bg-white/5 border border-white/10 hover:bg-white/20 text-sm" onclick="window.location.href='/material/${t.id}'"><i class="fas fa-folder-open mr-2"></i>View notes</button>
        </div>`; }).join('');
    }

    async function loadTimetable() {
      const container = document.getElementById('timetable-container');
      const data = await fetchData(ENDPOINTS.TIMETABLE);
      if (!data.length) { container.innerHTML = '<p class="text-slate-400 col-span-2 text-center glass-card p-6">ðŸ“† Timetable not published.</p>'; return; }
      container.innerHTML = data.map(day => `
        <div class="glass-card p-5 rounded-xl">
          <h3 class="text-xl font-bold text-white mb-3 border-b border-white/10 pb-2">${day.day}</h3>
          ${day.slots.map(s => `
            <div class="flex justify-between py-2 border-b border-white/5 last:border-0 hover:bg-white/5 px-2 rounded-lg transition text-sm">
              <div><span class="font-medium text-white">${s.subject}</span><span class="text-xs text-slate-400 block">${s.teacher || 'TBA'}</span></div>
              <div class="text-right"><span class="text-blue-400">${s.time}</span><span class="text-xs text-slate-400 block">${s.room || 'TBA'}</span></div>
            </div>`).join('')}
        </div>`).join('');
    }

    new Typed('#typed-hero', {
      strings: [
        'Your central hub for class announcements, assignments, timetables and course materials.',
        'Your one-stop hub for announcements, assignments, schedules, and learning resources.',
        'Stay organized with all your class updates, assignments, and materials in one place.',
        'The central platform for course updates, study materials, timetables, and assignments.'
      ],
      typeSpeed: 30, backSpeed: 30, loop: true, backDelay: 2500, cursorChar: 'â–Œ'
    });

    const progress = document.getElementById('scrollProgress');
    window.addEventListener('scroll', () => {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      progress.style.width = (winScroll / height) * 100 + '%';
    });

    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', function(e) {
        const id = this.getAttribute('href');
        if (id === '#') return;
        const el = document.querySelector(id);
        if (el) { e.preventDefault(); el.scrollIntoView({ behavior: 'smooth' }); }
      });
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/service-worker.js')
          .then(reg => console.log('âœ… SW registered:', reg.scope))
          .catch(err => console.error('âŒ SW registration failed:', err));
      });
    }
          window.addEventListener('online', () => location.reload());
    window.addEventListener('offline', () => {
      if (location.pathname !== '/offline.html') {
        location.href = '/offline.html';
      }
    });
          
    window.addEventListener('DOMContentLoaded', () => {
      loadAnnouncements();
      loadAssignments();
      loadTopics();
      loadTimetable();
      setTimeout(() => toastSystem.success('âœ… Welcome to LyxNexus', 'LyxNexus'), 800);
    });
  </script>
  <script>
    (function() {
        'use strict';
        
        const REDIRECT_TIMEOUT = 30000;
        const REDIRECT_URL = '/ln-ads';
        
        let idleTimer = null;
        
        function resetTimer() {
            if (idleTimer) clearTimeout(idleTimer);
            idleTimer = setTimeout(() => {
                window.location.href = REDIRECT_URL;
            }, REDIRECT_TIMEOUT);
        }
        
        ['mousemove', 'mousedown', 'keydown', 'touchstart', 'scroll'].forEach(event => {
            window.addEventListener(event, resetTimer, { passive: true });
        });
        
        resetTimer();
    })();
  </script>  
  <script>
    function createFloatingDots() {
        const container = document.getElementById('dots');
        const dotCount = 50;
        
        for (let i = 0; i < dotCount; i++) {
            const dot = document.createElement('div');
            dot.className = 'dot';
            
            const size = Math.random() * 4 + 1;
            const left = Math.random() * 100;
            const duration = Math.random() * 10 + 10;
            const delay = Math.random() * 5;
            
            dot.style.width = `${size}px`;
            dot.style.height = `${size}px`;
            dot.style.left = `${left}%`;
            dot.style.animationDuration = `${duration}s`;
            dot.style.animationDelay = `${delay}s`;
            
            container.appendChild(dot);
        }
    }
    document.addEventListener('DOMContentLoaded', () => {
      createFloatingDots();
      
      document.querySelectorAll('.fade-in').forEach(el => {
          el.style.opacity = "0";
          el.style.transform = "translateY(30px)";
          el.style.transition = "opacity 0.8s ease, transform 0.8s ease";
      });
    });
    const backToTop = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 400) backToTop.classList.remove('hidden');
      else backToTop.classList.add('hidden');
    });
    backToTop?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
  </script>  
</body>
</html>