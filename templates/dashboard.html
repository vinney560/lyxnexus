<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | LyxNexus</title>
    <!-- SEO Meta -->
    <meta name="keywords" content="Lyx Nexus, Kisii LyxNexus, kisii lyxnexus, kisii university lyxnexus, kisii university lyx nexus, lyx nexus, lyxnexus" />
    <meta name="author" content="Vincent Kipngetich" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://lyxnexus.onrender.com/" />
    <link rel="icon" href="https://lyxnexus.onrender.com/uploads/favicon-1.png"/>
    
    <meta property="og:title" content="Dashboard | LyxNexus" />
    <meta property="og:description" content="LyxNexus Dashboard gives the full Platform User Allowed Information like: Total Usage, All Students and others"/>
    <meta property="og:image" content="https://lyxnexus.onrender.com/favicon.ico" />
    <meta property="og:url" content="https://lyxnexus.onrender.com/" />
    
    <meta name="twitter:card" content="summary" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: rgba(25, 25, 45, 0.7);
            --bg-hover: rgba(59, 130, 246, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --text-accent: #c7d2fe;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --gradient-warning: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --shadow-glow: 0 0 20px rgba(59, 130, 246, 0.3);
            --shadow-card: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
            --shadow-hover: 0 20px 40px -10px rgba(59, 130, 246, 0.4);
            --border-radius: 16px;
            --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Poppins', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--accent-blue), var(--accent-purple));
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--accent-purple), var(--accent-blue));
        }
        
        /* Typography */
        .gradient-text {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: textShimmer 3s ease-in-out infinite alternate;
        }
        
        @keyframes textShimmer {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        .text-gradient-blue {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .text-gradient-purple {
            background: linear-gradient(135deg, #a78bfa, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Card Design */
        .glass-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: var(--border-radius);
            transition: var(--transition-smooth);
            box-shadow: var(--shadow-card);
            overflow: hidden;
            position: relative;
        }
        
        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.05), 
                transparent);
            transition: left 0.7s ease;
        }
        
        .glass-card:hover::before {
            left: 100%;
        }
        
        .glass-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: var(--shadow-hover);
        }
        
        .stat-card {
            position: relative;
            overflow: hidden;
            border: none;
            background: linear-gradient(135deg, 
                rgba(30, 30, 50, 0.8), 
                rgba(20, 20, 40, 0.9));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .stat-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent,
                rgba(59, 130, 246, 0.1),
                transparent 30%
            );
            animation: rotate 4s linear infinite;
        }
        
        @keyframes rotate {
            100% {
                transform: rotate(360deg);
            }
        }
        
        .stat-card-content {
            position: relative;
            z-index: 1;
            background: inherit;
            border-radius: inherit;
        }
        
        /* Interactive Elements */
        .interactive-btn {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition-smooth);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .interactive-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.6s;
        }
        
        .interactive-btn:hover::before {
            left: 100%;
        }
        
        .interactive-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .interactive-btn:active {
            transform: translateY(-1px);
        }
        
        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, 
                rgba(20, 20, 40, 0.95), 
                rgba(15, 15, 35, 0.98));
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }
        
        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                var(--accent-blue), 
                var(--accent-purple), 
                var(--accent-green));
            background-size: 200% 100%;
            animation: gradientMove 3s ease infinite;
        }
        
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .nav-item {
            position: relative;
            padding: 14px 20px;
            margin: 4px 16px;
            border-radius: 12px;
            color: var(--text-secondary);
            transition: var(--transition-smooth);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
            overflow: hidden;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: linear-gradient(180deg, var(--accent-blue), var(--accent-purple));
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .nav-item:hover::before {
            transform: scaleY(1);
        }
        
        .nav-item:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--text-primary);
            transform: translateX(8px);
            padding-left: 24px;
        }
        
        .nav-item.active {
            background: rgba(59, 130, 246, 0.15);
            color: var(--text-primary);
            padding-left: 24px;
        }
        
        .nav-item.active::before {
            transform: scaleY(1);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        /* Avatar */
        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }
        
        .user-avatar::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0.3),
                rgba(255, 255, 255, 0.1)
            );
            transform: rotate(45deg);
            animation: avatarShine 3s ease-in-out infinite;
        }
        
        @keyframes avatarShine {
            0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .user-avatar:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.6);
        }
        
        /* Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .activity-item {
            padding: 16px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: 10px;
            transition: var(--transition-smooth);
            animation: slideInUp 0.5s ease-out;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .activity-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: linear-gradient(180deg, var(--accent-blue), var(--accent-purple));
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .activity-item:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: translateY(-4px);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .activity-item:hover::before {
            opacity: 1;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Loading States */
        .skeleton {
            background: linear-gradient(
                90deg,
                rgba(255, 255, 255, 0.05) 25%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(255, 255, 255, 0.05) 75%
            );
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s ease-in-out infinite;
            border-radius: 8px;
        }
        
        @keyframes skeletonLoading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Progress Indicator */
        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--accent-green);
        }
        
        .pulse-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-green);
            position: relative;
        }
        
        .pulse-dot::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s ease-out infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(2.5); opacity: 0; }
        }
        
        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(59, 130, 246, 0.2);
            color: var(--accent-blue);
            transition: var(--transition-smooth);
        }
        
        .badge:hover {
            background: rgba(59, 130, 246, 0.3);
            transform: scale(1.05);
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 34px;
            transition: var(--transition-smooth);
        }
        
        .toggle-slider:before {
            position: absolute;
            content: '';
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 50%;
            transition: var(--transition-smooth);
        }
        
        input:checked + .toggle-slider {
            background: rgba(59, 130, 246, 0.3);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        /* Tooltip */
        .tooltip {
            position: relative;
        }
        
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.875rem;
            white-space: nowrap;
            z-index: 1000;
            margin-bottom: 8px;
        }
        
        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                position: fixed;
                left: -280px;
                z-index: 50;
                height: 100vh;
                top: 0;
                box-shadow: 20px 0 50px rgba(0, 0, 0, 0.5);
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.7);
                backdrop-filter: blur(5px);
                z-index: 40;
            }
            
            .mobile-overlay.active {
                display: block;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .glass-card {
                border-radius: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .interactive-btn {
                padding: 10px 20px;
                font-size: 0.875rem;
            }
            
            .user-avatar {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }
        
        /* Page Load Animation */
        .page-load {
            animation: pageLoad 0.8s ease-out;
        }
        
        @keyframes pageLoad {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Confetti Effect */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
        }
        
        /* Floating Animation */
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* Counter Animation */
        .counter {
            animation: counterPop 0.5s ease-out;
        }
        
        @keyframes counterPop {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: var(--shadow-card);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
    </style>
</head>
<body class="page-load">
    <!-- Confetti Container -->
    <div id="confetti-container"></div>
    
    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-blue-500 flex items-center justify-center">
                <i class="fas fa-check text-white text-sm"></i>
            </div>
            <div>
                <p class="font-semibold" id="notification-title">Success</p>
                <p class="text-sm text-gray-400" id="notification-message">Action completed successfully</p>
            </div>
        </div>
    </div>
    
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Logo -->
            <div class="p-6 border-b border-white/10">
                <div class="flex items-center gap-3 cursor-pointer" onclick="window.location.href='/'">
                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg">
                        <i class="fas fa-graduation-cap text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold gradient-text">LyxNexus</h1>
                        <p class="text-xs text-gray-400 mt-1">Student Dashboard</p>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="py-6 overflow-y-auto h-[calc(100vh-140px)]">
                <div class="px-4">
                    <p class="text-xs uppercase text-gray-500 font-semibold mb-3 px-4">Navigation</p>
                    <div class="space-y-1">
                        <div class="nav-item active" onclick="window.location.href='/dashboard'">
                            <i class="fas fa-tachometer-alt w-5"></i>
                            <span>Dashboard</span>
                            <div class="ml-auto w-2 h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 animate-pulse"></div>
                        </div>
                        <div class="nav-item" onclick="window.history.back()">
                            <i class="fas fa-arrow-left w-5"></i>
                            <span>Go Back</span>
                        </div>
                        <div class="nav-item" onclick="window.location.href='/main-page'">
                            <i class="fas fa-home w-5"></i>
                            <span>Main Page</span>
                        </div>
                        <div class="nav-item" onclick="window.location.href='/portfolio'">
                            <i class="fas fa-book w-5"></i>
                            <span>Portfolio</span>
                            <span class="ml-auto badge">New</span>
                        </div>
                        <div class="nav-item" onclick="window.location.href='/assignments'">
                            <i class="fas fa-tasks w-5"></i>
                            <span>Assignments</span>
                        </div>
                        <div class="nav-item" onclick="window.location.href='/card'">
                            <i class="fas fa-credit-card w-5"></i>
                            <span>Card</span>
                        </div>
                        <div class="nav-item" onclick="window.location.href='/konami'">
                            <i class="fas fa-gamepad w-5"></i>
                            <span>Konami</span>
                            <span class="ml-auto badge">New</span>
                            <div class="ml-auto w-2 h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 animate-pulse"></div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <p class="text-xs uppercase text-gray-500 font-semibold mb-3 px-4">Quick Actions</p>
                        <div class="space-y-1">
                            <div class="nav-item" onclick="refreshDashboard()">
                                <i class="fas fa-sync-alt w-5"></i>
                                <span>Refresh Data</span>
                            </div>
                            <div class="nav-item" onclick="showNotification('Feature Coming Soon', 'This feature is under development')">
                                <i class="fas fa-chart-line w-5"></i>
                                <span>Analytics</span>
                            </div>
                            <div class="nav-item" onclick="showNotification('Feature Coming Soon', 'This feature is under development')">
                                <i class="fas fa-download w-5"></i>
                                <span>Export Data</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- User Profile -->
            <div class="absolute bottom-0 w-full p-6 border-t border-white/10">
                <div class="flex items-center gap-3">
                    <div class="user-avatar cursor-pointer" id="sidebar-user-avatar" 
                         onclick="window.location.href='/profile'"
                         data-tooltip="View Profile">
                        LN
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-medium truncate" id="sidebar-username">Loading...</p>
                        <div class="flex items-center gap-2 mt-1">
                            <div class="w-2 h-2 rounded-full bg-gradient-to-r from-green-400 to-blue-500"></div>
                            <p class="text-xs text-gray-400 truncate">Active Now</p>
                        </div>
                    </div>
                    <button class="text-gray-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/5"
                            onclick="window.location.href='/logout'"
                            data-tooltip="Sign Out">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Overlay -->
        <div class="mobile-overlay" onclick="toggleSidebar()"></div>
        
        <!-- Main Content -->
        <div class="flex-1 overflow-x-hidden">
            <!-- Header -->
            <header class="sticky top-0 z-30 bg-black/40 backdrop-blur-xl border-b border-white/10">
                <div class="flex items-center justify-between p-4 md:p-6">
                    <div class="flex items-center gap-4">
                        <button class="mobile-menu-btn p-2 rounded-lg hover:bg-white/5 transition-colors"
                                onclick="toggleSidebar()">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <div>
                            <h1 class="text-xl md:text-2xl font-bold gradient-text">Dashboard</h1>
                            <div class="flex items-center gap-2 mt-1">
                                <div class="live-indicator">
                                    <div class="pulse-dot"></div>
                                    <span class="hidden sm:inline">Live Updates</span>
                                </div>
                                <span class="text-xs text-gray-400" id="welcome-message">Welcome back</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-3">
                        <!-- Refresh Button -->
                        <button class="interactive-btn" id="refreshData" onclick="refreshDashboard()">
                            <i class="fas fa-sync-alt"></i>
                            <span class="hidden sm:inline">Refresh</span>
                        </button>
                        
                        <!-- Notifications -->
                        <div class="relative">
                            <button class="w-10 h-10 rounded-full bg-white/5 hover:bg-white/10 transition-colors flex items-center justify-center relative"
                                    onclick="#"
                                    data-tooltip="Notifications">
                                <i class="fas fa-bell"></i>
                                <span class="absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center text-xs font-bold">
                                    3
                                </span>
                            </button>
                        </div>
                        
                        <!-- User Menu -->
                        <div class="relative">
                            <button class="flex items-center gap-2 p-2 rounded-lg hover:bg-white/5 transition-colors"
                                    onclick="#">
                                <div class="user-avatar" id="header-user-avatar">LN</div>
                                <div class="hidden md:block text-left">
                                    <p class="font-medium text-sm truncate max-w-[120px]" id="header-username">Loading...</p>
                                    <p class="text-xs text-gray-400">Student</p>
                                </div>
                                <i class="fas fa-chevron-down text-xs text-gray-400"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main Content Area -->
            <main class="p-4 md:p-6">
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <!-- Total Visits -->
                    <div class="stat-card glass-card" onclick="showStatDetails('visits')">
                        <div class="stat-card-content p-6">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-400 text-sm font-medium mb-2">Total Visits</p>
                                    <h3 class="text-3xl font-bold text-gradient-blue counter" id="total-visits">0</h3>
                                    <div class="flex items-center gap-2 mt-3">
                                        <i class="fas fa-arrow-up text-green-400"></i>
                                        <span class="text-sm text-gray-300" id="visits-trend">Loading...</span>
                                    </div>
                                </div>
                                <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-blue-500/20 to-blue-500/10 flex items-center justify-center">
                                    <i class="fas fa-chart-line text-blue-400 text-2xl floating"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Account Status -->
                    <div class="stat-card glass-card" onclick="showStatDetails('status')">
                        <div class="stat-card-content p-6">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-400 text-sm font-medium mb-2">Account Status</p>
                                    <h3 class="text-3xl font-bold text-gradient-purple counter" id="user-status">Active</h3>
                                    <div class="flex items-center gap-2 mt-3">
                                        <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                                        <span class="text-sm text-gray-300" id="status-trend">All systems go</span>
                                    </div>
                                </div>
                                <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-purple-500/20 to-purple-500/10 flex items-center justify-center">
                                    <i class="fas fa-user-check text-purple-400 text-2xl floating"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Available Files -->
                    <div class="stat-card glass-card" onclick="showStatDetails('files')">
                        <div class="stat-card-content p-6">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-400 text-sm font-medium mb-2">Available Files</p>
                                    <h3 class="text-3xl font-bold text-gradient-blue counter" id="available-files">0</h3>
                                    <div class="flex items-center gap-2 mt-3">
                                        <i class="fas" id="files-icon"></i>
                                        <span class="text-sm text-gray-300" id="if-enough-files">Loading...</span>
                                    </div>
                                </div>
                                <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-cyan-500/20 to-cyan-500/10 flex items-center justify-center">
                                    <i class="fas fa-cloud-upload-alt text-cyan-400 text-2xl floating"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Total Students -->
                    <div class="stat-card glass-card" onclick="showStatDetails('students')">
                        <div class="stat-card-content p-6">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-400 text-sm font-medium mb-2">Total Students</p>
                                    <h3 class="text-3xl font-bold text-gradient-purple counter" id="all-students">0</h3>
                                    <div class="flex items-center gap-2 mt-3">
                                        <i class="fas fa-users text-blue-400"></i>
                                        <span class="text-sm text-gray-300" id="students-trend">Loading...</span>
                                    </div>
                                </div>
                                <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-green-500/20 to-green-500/10 flex items-center justify-center">
                                    <i class="fas fa-users text-green-400 text-2xl floating"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    <!-- User Profile Card -->
                    <div class="glass-card lg:col-span-1">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold gradient-text">Student Profile</h3>
                                <button class="text-gray-400 hover:text-white transition-colors" 
                                        onclick="window.location.href='/profile'"
                                        data-tooltip="Edit Profile">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                            
                            <div class="text-center mb-6">
                                <div class="user-avatar mx-auto mb-4 w-20 h-20 text-2xl cursor-pointer"
                                     onclick="window.location.href='/profile'"
                                     id="profile-avatar">LN</div>
                                <h4 class="text-xl font-bold mb-2" id="profile-username">Loading...</h4>
                                <p class="text-gray-400 mb-1" id="profile-role">Loading...</p>
                                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 mt-2">
                                    <div class="w-2 h-2 rounded-full bg-gradient-to-r from-green-400 to-blue-500 animate-pulse"></div>
                                    <span class="text-sm text-gray-300">Online</span>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div class="flex justify-between items-center p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer" 
                                     onclick="copyToClipboard('profile-id')">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center">
                                            <i class="fas fa-id-card text-blue-400"></i>
                                        </div>
                                        <span class="text-gray-400 text-sm">Student ID</span>
                                    </div>
                                    <span class="font-semibold text-blue-400 text-sm" id="profile-id">--</span>
                                </div>
                                
                                <div class="flex justify-between items-center p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                                            <i class="fas fa-calendar-alt text-purple-400"></i>
                                        </div>
                                        <span class="text-gray-400 text-sm">Study Year</span>
                                    </div>
                                    <span class="font-semibold text-purple-400" id="study-year">--</span>
                                </div>
                                
                                <div class="flex justify-between items-center p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors" 
                                     onclick="copyToClipboard('profile-mobile')">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center">
                                            <i class="fas fa-phone text-green-400"></i>
                                        </div>
                                        <span class="text-gray-400 text-sm">Mobile</span>
                                    </div>
                                    <span class="font-semibold text-green-400" id="profile-mobile">--</span>
                                </div>
                                
                                <div class="flex justify-between items-center p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center">
                                            <i class="fas fa-calendar text-yellow-400"></i>
                                        </div>
                                        <span class="text-gray-400 text-sm">Member Since</span>
                                    </div>
                                    <span class="font-semibold text-yellow-400" id="profile-joined">--</span>
                                </div>
                                
                                <div class="flex justify-between items-center p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-red-500/20 flex items-center justify-center">
                                            <i class="fas fa-shield-alt text-red-400"></i>
                                        </div>
                                        <span class="text-gray-400 text-sm">Admin Access</span>
                                    </div>
                                    <span class="font-semibold" id="profile-admin">No</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="glass-card lg:col-span-2">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h3 class="text-lg font-bold gradient-text">Recent Activity</h3>
                                    <p class="text-gray-400 text-sm mt-1" id="activity-count">0 activities today</p>
                                </div>
                                <button class="text-gray-400 hover:text-white transition-colors text-sm flex items-center gap-2"
                                        onclick="loadActivity()">
                                    <i class="fas fa-redo"></i>
                                    <span>Reload</span>
                                </button>
                            </div>
                            
                            <div class="activity-feed" id="activity-feed">
                                <!-- Activity items will be loaded here -->
                                <div class="empty-state">
                                    <i class="fas fa-history"></i>
                                    <p class="text-gray-400">Loading activities...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Activity Chart -->
                    <div class="glass-card">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold gradient-text">Activity Overview</h3>
                                <div class="flex gap-2">
                                    <button class="text-xs px-3 py-1 rounded-full bg-gradient-to-r from-blue-500/20 to-blue-500/10 text-blue-400 font-medium transition-colors hover:bg-blue-500/30" 
                                            onclick="updateChartPeriod('7d')">7D</button>
                                    <button class="text-xs px-3 py-1 rounded-full bg-white/5 text-gray-400 font-medium transition-colors hover:bg-white/10"
                                            onclick="updateChartPeriod('30d')">30D</button>
                                </div>
                            </div>
                            <div class="h-72">
                                <canvas id="activityChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Platform Usage -->
                    <div class="glass-card">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold gradient-text">Platform Usage</h3>
                                <i class="fas fa-chart-pie text-purple-400 floating"></i>
                            </div>
                            <div class="h-72">
                                <canvas id="usageChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- Footer -->
            <footer class="p-6 border-t border-white/10">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-white text-sm"></i>
                        </div>
                        <div>
                            <p class="font-bold gradient-text">LyxNexus Student Dashboard</p>
                            <p class="text-xs text-gray-400 mt-1">Â© 2026 All rights reserved</p>
                        </div>
                    </div>
                    <div class="flex gap-4">
                        <button class="text-gray-400 hover:text-white transition-colors text-sm"
                                onclick="showNotification('Contact Support', 'support@lyxnexus.com')">
                            Support
                        </button>
                        <button class="text-gray-400 hover:text-white transition-colors text-sm"
                                onclick="showNotification('Feedback', 'Thank you for your feedback!')">
                            Feedback
                        </button>
                        <button class="text-gray-400 hover:text-white transition-colors text-sm"
                                onclick="showNotification('Version', 'Dashboard v3.04')">
                            v3.04
                        </button>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <script>
        // Global Variables
        let activityChart, usageChart;
        let userDataCache = null;
        let currentChartPeriod = '7d';
        
        // Enhanced Chart Configuration
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
                duration: 2000,
                easing: 'easeOutQuart'
            },
            plugins: {
                legend: { 
                    display: true,
                    position: 'bottom',
                    labels: {
                        color: '#a0aec0',
                        padding: 20,
                        usePointStyle: true,
                        pointStyle: 'circle',
                        font: {
                            size: 11,
                            family: "'Inter', sans-serif"
                        }
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(15, 15, 35, 0.95)',
                    titleColor: '#ffffff',
                    bodyColor: '#c7d2fe',
                    borderColor: 'rgba(59, 130, 246, 0.3)',
                    borderWidth: 1,
                    cornerRadius: 8,
                    displayColors: true,
                    callbacks: {
                        labelColor: function(context) {
                            return {
                                borderColor: context.dataset.backgroundColor,
                                backgroundColor: context.dataset.backgroundColor,
                                borderWidth: 2,
                                borderRadius: 2,
                            };
                        }
                    }
                }
            }
        };
        
        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Load data with a slight delay for smoother UX
            setTimeout(() => {
                loadDashboardData();
            }, 300);
            
            // Set up auto-refresh (every 2 minutes)
            setInterval(loadDashboardData, 120000);
            
            // Add click animations to cards
            document.querySelectorAll('.stat-card').forEach(card => {
                card.addEventListener('click', function() {
                    createRippleEffect(this);
                });
            });
            
            // Initialize tooltips
            initializeTooltips();
        });
        
        // Load Dashboard Data
        async function loadDashboardData() {
            try {
                showLoadingState();
                
                // Log dashboard view
                await logActivity('view', 'dashboard');
                
                // Fetch user data
                const userResponse = await fetch('/dashboard/api/data');
                if (!userResponse.ok) throw new Error(`HTTP error! status: ${userResponse.status}`);
                const userData = await userResponse.json();
                userDataCache = userData;
                
                // Update UI with user data
                updateUserProfile(userData._data);
                
                // Fetch activity data
                const activityResponse = await fetch('/dashboard/api/activity');
                if (!activityResponse.ok) throw new Error(`HTTP error! status: ${activityResponse.status}`);
                const activityData = await activityResponse.json();
                
                // Update activity feed
                updateActivityFeed(activityData);
                
                // Fetch stats for charts
                const statsResponse = await fetch('/dashboard/api/stats');
                if (statsResponse.ok) {
                    const statsData = await statsResponse.json();
                    updateCharts(userData._data, activityData, statsData);
                } else {
                    updateCharts(userData._data, activityData, null);
                }
                
                // Show success notification
                showNotification('Dashboard Updated', 'All data has been refreshed successfully');
                
            } catch (error) {
                console.error('Failed to load dashboard data:', error);
                showNotification('Update Failed', 'Could not refresh dashboard data', 'error');
            } finally {
                hideLoadingState();
            }
        }
        
        // Update User Profile
        function updateUserProfile(user) {
            // Update user info
            const username = user.username || 'User';
            const initials = username.charAt(0).toUpperCase();
            
            // Update all avatar elements
            document.getElementById('sidebar-user-avatar').textContent = initials;
            document.getElementById('header-user-avatar').textContent = initials;
            document.getElementById('profile-avatar').textContent = initials;
            
            // Update username displays
            document.getElementById('sidebar-username').textContent = username;
            document.getElementById('header-username').textContent = username;
            document.getElementById('profile-username').textContent = username;
            document.getElementById('welcome-message').textContent = `Welcome back, ${username}`;
            
            // Update user details with animations
            document.getElementById('user-status').textContent = user.status ? 'Active' : 'Inactive';
            document.getElementById('status-trend').textContent = user.status ? 'All systems operational' : 'Account requires attention';
            
            // File statistics with conditional styling
            const availableFiles = user.available_files || 0;
            animateCounter('available-files', availableFiles);
            const filesIcon = document.getElementById('files-icon');
            const filesStatus = document.getElementById('if-enough-files');
            
            if (availableFiles >= 80) {
                filesIcon.className = 'fas fa-arrow-up text-green-400';
                filesStatus.textContent = 'â Sufficient resources';
                filesStatus.className = 'text-sm text-green-400';
            } else {
                filesIcon.className = 'fas fa-arrow-down text-yellow-400';
                filesStatus.textContent = 'â¬ Limited resources';
                filesStatus.className = 'text-sm text-yellow-400';
            }
            
            // Student count with animation
            const totalStudents = user.all_students || 0;
            animateCounter('all-students', totalStudents);
            const studentsStatus = document.getElementById('students-trend');
            
            if (totalStudents >= 200) {
                studentsStatus.innerHTML = '<i class="fas fa-users text-blue-400"></i> Large community';
                studentsStatus.className = 'text-sm text-blue-400';
            } else {
                studentsStatus.innerHTML = '<i class="fas fa-user-friends text-gray-400"></i> Growing community';
                studentsStatus.className = 'text-sm text-gray-400';
            }
            
            // Profile details
            document.getElementById('profile-id').textContent = user.id || '--';
            document.getElementById('study-year').textContent = user.year || 'Not specified';
            document.getElementById('profile-mobile').textContent = user.mobile || 'Not provided';
            document.getElementById('profile-joined').textContent = user.created_at || '--';
            document.getElementById('profile-admin').textContent = user.is_admin ? 'Yes' : 'No';
            document.getElementById('profile-admin').className = user.is_admin ? 'font-semibold text-gradient-purple' : 'font-semibold text-gray-400';
            document.getElementById('profile-role').textContent = user.is_admin ? 'Administrator' : 'Student';
            
            // Visits trend
            const visitsTrend = document.getElementById('visits-trend');
            const visits = user.visits || 0;
            if (visits > 50) {
                visitsTrend.innerHTML = '<i class="fas fa-arrow-up text-green-400"></i> High engagement';
            } else if (visits > 20) {
                visitsTrend.innerHTML = '<i class="fas fa-arrow-up text-blue-400"></i> Regular usage';
            } else {
                visitsTrend.innerHTML = '<i class="fas fa-seedling text-yellow-400"></i> Getting started';
            }
        }
        
        // Update Activity Feed
        function updateActivityFeed(activityData) {
            const feed = document.getElementById('activity-feed');
            const activityCount = document.getElementById('activity-count');
            
            if (!activityData.success || !activityData.visited_page) {
                feed.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p class="text-gray-400">Unable to load activity data</p>
                        <button class="interactive-btn mt-4" onclick="loadDashboardData()">
                            <i class="fas fa-redo"></i>
                            Try Again
                        </button>
                    </div>
                `;
                activityCount.textContent = '0 activities';
                return;
            }
            
            const activities = activityData.visited_page;
            activityCount.textContent = `${activities.length} recent activities`;
            animateCounter('total-visits', activities.length || 0);
            
            if (activities.length === 0) {
                feed.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p class="text-gray-400">No recent activity found</p>
                        <p class="text-sm text-gray-500 mt-2">Start exploring the platform!</p>
                    </div>
                `;
                return;
            }
            
            feed.innerHTML = activities.slice(0, 5).map((activity, index) => `
                <div class="activity-item" style="animation-delay: ${index * 0.1}s" 
                     onclick="showActivityDetails('${activity.action}', '${activity.target}')">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-500/20 flex items-center justify-center">
                            <i class="fas fa-${getActivityIcon(activity.action, activity.target)} text-blue-400"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center justify-between mb-1">
                                <h4 class="font-semibold text-sm truncate">${formatActivityTitle(activity.action, activity.target)}</h4>
                                <span class="text-xs text-gray-500">${formatActivityTime(activity.timestamp)}</span>
                            </div>
                            <p class="text-xs text-gray-400 truncate">${formatActivityDescription(activity.action, activity.target)}</p>
                            ${activity.duration ? `
                                <div class="flex items-center gap-2 mt-2">
                                    <div class="flex-1 h-1 bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-gradient-to-r from-blue-500 to-purple-500" 
                                             style="width: ${Math.min(100, activity.duration / 60 * 100)}%"></div>
                                    </div>
                                    <span class="text-xs text-gray-500">${activity.duration}s</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Update Charts
        function updateCharts(userData, activityData, statsData) {
            updateActivityChart(userData, activityData, statsData);
            updateUsageChart(userData, activityData, statsData);
        }
        
        function updateActivityChart(userData, activityData, statsData) {
            const ctx = document.getElementById('activityChart').getContext('2d');
            if (activityChart) activityChart.destroy();
            
            let labels, data;
            if (statsData?.success && statsData.weekly_activity) {
                labels = statsData.weekly_activity.map(item => item.date);
                data = statsData.weekly_activity.map(item => item.count);
            } else {
                labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                data = [12, 19, 8, 15, 12, 20, 18];
            }
            
            activityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Daily Activity',
                        data: data,
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderColor: '#3b82f6',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    ...chartConfig,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)',
                                borderDash: [3, 3]
                            },
                            ticks: {
                                color: '#a0aec0',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#a0aec0',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateUsageChart(userData, activityData, statsData) {
            const ctx = document.getElementById('usageChart').getContext('2d');
            if (usageChart) usageChart.destroy();
            
            let labels, data;
            if (statsData?.success && statsData.action_stats) {
                labels = Object.keys(statsData.action_stats);
                data = Object.values(statsData.action_stats);
            } else {
                labels = ['Dashboard', 'Profile', 'Settings', 'Materials', 'Assignments'];
                data = [35, 25, 15, 15, 10];
            }
            
            usageChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'
                        ],
                        borderWidth: 0,
                        hoverOffset: 20
                    }]
                },
                options: {
                    ...chartConfig,
                    cutout: '70%',
                    plugins: {
                        ...chartConfig.plugins,
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Helper Functions
        function getActivityIcon(action, target) {
            const icons = {
                'view': 'eye',
                'create': 'plus-circle',
                'update': 'edit',
                'delete': 'trash-alt',
                'login': 'sign-in-alt',
                'logout': 'sign-out-alt',
                'download': 'download',
                'upload': 'upload',
                'dashboard': 'tachometer-alt',
                'profile': 'user-circle',
                'settings': 'cog',
                'announcements': 'bullhorn',
                'assignments': 'tasks'
            };
            return icons[action] || icons[target] || 'file-alt';
        }
        
        function formatActivityTitle(action, target) {
            const actions = {
                'view': 'Viewed',
                'create': 'Created',
                'update': 'Updated',
                'delete': 'Deleted',
                'login': 'Logged in',
                'logout': 'Logged out'
            };
            
            const targets = {
                'dashboard': 'Dashboard',
                'profile': 'Profile',
                'settings': 'Settings',
                'announcements': 'Announcements',
                'assignments': 'Assignments'
            };
            
            return `${actions[action] || 'Accessed'} ${targets[target] || target || 'page'}`;
        }
        
        function formatActivityDescription(action, target) {
            return `${action.charAt(0).toUpperCase() + action.slice(1)} action on ${target || 'the platform'}`;
        }
        
        function formatActivityTime(timestamp) {
            if (!timestamp || timestamp === 'Unknown') return 'Just now';
            
            try {
                const date = new Date(timestamp);
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins}m ago`;
                if (diffHours < 24) return `${diffHours}h ago`;
                if (diffDays < 7) return `${diffDays}d ago`;
                return date.toLocaleDateString();
            } catch (e) {
                return 'Recently';
            }
        }
        
        // Interactive Functions
        function refreshDashboard() {
            const btn = document.getElementById('refreshData');
            const originalHTML = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;
            
            // Add ripple effect
            createRippleEffect(btn);
            
            // Animate stat cards
            document.querySelectorAll('.stat-card').forEach((card, index) => {
                setTimeout(() => {
                    card.style.transform = 'translateY(-8px) scale(1.02)';
                    setTimeout(() => {
                        card.style.transform = '';
                    }, 300);
                }, index * 100);
            });
            
            // Load data
            loadDashboardData().finally(() => {
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                    
                    // Create confetti effect
                    createConfetti();
                }, 1000);
            });
        }
        
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.mobile-overlay');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notification-title');
            const messageEl = document.getElementById('notification-message');
            
            // Set content
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            // Set type-based styling
            const icon = notification.querySelector('.w-8');
            if (type === 'error') {
                icon.className = 'w-8 h-8 rounded-full bg-gradient-to-r from-red-500 to-pink-500 flex items-center justify-center';
                icon.innerHTML = '<i class="fas fa-exclamation text-white text-sm"></i>';
            } else if (type === 'warning') {
                icon.className = 'w-8 h-8 rounded-full bg-gradient-to-r from-yellow-500 to-orange-500 flex items-center justify-center';
                icon.innerHTML = '<i class="fas fa-exclamation-triangle text-white text-sm"></i>';
            } else {
                icon.className = 'w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-blue-500 flex items-center justify-center';
                icon.innerHTML = '<i class="fas fa-check text-white text-sm"></i>';
            }
            
            // Show notification
            notification.classList.add('show');
            
            // Auto-hide after 4 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        
        function showStatDetails(statType) {
            const messages = {
                visits: 'Total number of times you have visited the platform',
                status: 'Current status of your account and access level',
                files: 'Number of study materials available for your course',
                students: 'Total number of students registered on the platform'
            };
            
            showNotification(
                statType.charAt(0).toUpperCase() + statType.slice(1) + ' Details',
                messages[statType] || 'Detailed information about this statistic',
                'info'
            );
        }
        
        function showActivityDetails(action, target) {
            showNotification(
                'Activity Details',
                `You ${action}ed ${target || 'this page'} recently`,
                'info'
            );
        }
        
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Copied!', `${elementId.replace('profile-', '').toUpperCase()} copied to clipboard`);
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }
        
        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            const current = parseInt(element.textContent) || 0;
            const duration = 1500;
            const startTime = Date.now();
            
            function updateCounter() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3); // Ease out cubic
                const currentValue = Math.floor(current + (targetValue - current) * easeProgress);
                
                element.textContent = currentValue;
                
                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                } else {
                    element.textContent = targetValue;
                    element.classList.add('counter');
                    setTimeout(() => element.classList.remove('counter'), 500);
                }
            }
            
            updateCounter();
        }
        
        function createRippleEffect(element) {
            const ripple = document.createElement('span');
            const rect = element.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                border-radius: 50%;
                background: rgba(255, 255, 255, 0.3);
                transform: scale(0);
                animation: ripple-animation 0.6s linear;
                width: ${size}px;
                height: ${size}px;
                top: ${y}px;
                left: ${x}px;
                pointer-events: none;
            `;
            
            element.style.position = 'relative';
            element.style.overflow = 'hidden';
            element.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }
        
        function createConfetti() {
            const container = document.getElementById('confetti-container');
            const colors = [
                '#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444',
                '#ec4899', '#14b8a6', '#f97316', '#8b5cf6'
            ];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = confetti.style.width;
                confetti.style.opacity = '1';
                
                container.appendChild(confetti);
                
                // Animate confetti
                const animation = confetti.animate([
                    {
                        transform: `translateY(0) rotate(0deg)`,
                        opacity: 1
                    },
                    {
                        transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 360}deg)`,
                        opacity: 0
                    }
                ], {
                    duration: Math.random() * 3000 + 2000,
                    easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }
        
        function initializeTooltips() {
            const tooltips = document.querySelectorAll('[data-tooltip]');
            tooltips.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip-content';
                    tooltip.textContent = this.getAttribute('data-tooltip');
                    tooltip.style.cssText = `
                        position: fixed;
                        background: rgba(0, 0, 0, 0.9);
                        color: white;
                        padding: 8px 12px;
                        border-radius: 6px;
                        font-size: 0.75rem;
                        white-space: nowrap;
                        z-index: 1000;
                        pointer-events: none;
                        transform: translate(-50%, -100%);
                        margin-top: -8px;
                    `;
                    
                    const rect = this.getBoundingClientRect();
                    tooltip.style.left = rect.left + rect.width / 2 + 'px';
                    tooltip.style.top = rect.top + 'px';
                    
                    document.body.appendChild(tooltip);
                    
                    this._tooltip = tooltip;
                });
                
                element.addEventListener('mouseleave', function() {
                    if (this._tooltip) {
                        this._tooltip.remove();
                        delete this._tooltip;
                    }
                });
            });
        }
        
        function showLoadingState() {
            document.body.style.cursor = 'wait';
            document.querySelectorAll('.stat-card').forEach(card => {
                card.style.opacity = '0.7';
            });
        }
        
        function hideLoadingState() {
            document.body.style.cursor = 'default';
            document.querySelectorAll('.stat-card').forEach(card => {
                card.style.opacity = '1';
            });
        }
        
        // Log activity function (same as before)
        async function logActivity(action, target, duration = 0) {
            try {
                await fetch('/dashboard/api/log_activity', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: action,
                        target: target,
                        duration: duration
                    })
                });
            } catch (error) {
                console.error('Failed to log activity:', error);
            }
        }
        
        // Add ripple animation to CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple-animation {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>